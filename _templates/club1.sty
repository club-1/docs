% Paquet LaTeX permettant de customiser le rendu du PDF.
\ProvidesPackage{club1}[2022/05/17 Customisations LaTeX CLUB1]

% Définition de TwemojiMozilla comme police de substitution
% pour pouvoir l'utiliser lorsque des caractères sont introuvables,
% notamment lorsqu'il s'agit d'emojis.
\directlua{
	luaotfload.add_fallback("emoji", {"[TwemojiMozilla.ttf]:mode=harf"})
}
% Définition des polices du document,
% en spécifiant la police de substitution.
\setmainfont{LatinModernRoman}[RawFeature={fallback=emoji},SmallCapsFont={* Caps}]
\setsansfont{LatinModernSans}[RawFeature={fallback=emoji}]
\setmonofont{DejaVuSansMono}[RawFeature={fallback=emoji},Scale=0.8]

% Rétablit le style de liste standard en français.
\ifdefined\frenchsetup
	\frenchsetup{StandardListSpacing=true,StandardItemLabels=true}
\fi

% Définition du point médian.
% La commande \textperiodcentered créé un point médian mais entouré
% d'espaces : "cher{\textperiodcentered}es" devient "cher · es".
% Le problème est le même si l'on saisit directement le caractère
% "middle dot" (U+00B7): "cher·es" devient "cher · es".
% On remplace donc ce caractère par \cdot.
\RequirePackage{newunicodechar}
\newunicodechar{·}{\cdot}

% Augmentation de la DPI des images qui ne l'ont pas définie.
\pdfimageresolution=140

% Définition des paramètres de rendu de Sphinx.
\sphinxsetup{
	verbatimwithframe=true,
	VerbatimColor={named}{MintCream},
	% TitleColor={named}{DarkGoldenrod},
	noteBorderColor={named}{SteelBlue},
	tipBorderColor={named}{LightSeaGreen},
	importantBorderColor={named}{LightSeaGreen},
	dangerBorderColor={named}{Crimson},
	dangerBgColor={named}{MistyRose},
	cautionBorderColor={named}{Orange},
	cautionBgColor={named}{LemonChiffon},
	attentionBorderColor={named}{Orange},
	attentionBgColor={named}{LemonChiffon},
	warningBorderColor={named}{Orange},
	warningBgColor={named}{LemonChiffon}
}

% Augmentation de la marge intérieure.
\geometry{inner=33mm}

% Commence la numérotation avec des lettres pour les pages de titres.
\pagenumbering{alph}

% Utilisation du thème d'entête de chapitres "Bjornstrup".
\RequirePackage[Bjornstrup]{fncychap}
% Customisation du thème Bjornstrup pour éviter les erreurs overfull hbox.
% Voir https://tex.stackexchange.com/a/133064
\renewcommand{\DOCH}{
	\settowidth{\py}{\CNoV\thechapter}
	\addtolength{\py}{-7pt} % Décalage du nombre vers la droite.
	\fboxsep=0pt
	\colorbox[gray]{.85}{\rule{0pt}{40pt}\parbox[b]{\textwidth}{\hfill}}
	\kern-\py\raise20pt
	\rlap{\color[gray]{.5}\CNoV\thechapter}\\
}

% Affichage de l'index en 3 colones au lieu de 2.
\RequirePackage[columns=3]{idxlayout}

% Définit une commande d'espacement spécifiquement utilisé pour l'index.
% Remplis l'espace avec une ligne de points alignés verticalement.
\newcommand \idxopen {\leavevmode \leaders \hb@xt@ .66em{\hss .\hss }\hfill \kern \z@}

% Customisation des tableaux.
% Élargissement du padding des cellules.
\setlength{\tabcolsep}{10pt} % horizontal, defaut : 6pt
\renewcommand\arraystretch{1.5} % vertical
% Style de texte de la ligne de titre (Sans serif gras).
\renewcommand\sphinxstyletheadfamily{\sffamily\bfseries}

% Customisation des citations pour les uniformiser avec la version HTML.
\RequirePackage{mdframed}
\mdfdefinestyle{QuoteFrame}{
	fontcolor=darkgray,
	linecolor=lightgray,
	linewidth=3pt,
	rightline=false, topline=false, bottomline=false,
	innerleftmargin=16pt, innerrightmargin=0pt,
	innertopmargin=5pt, innerbottommargin=4pt,
	skipabove=8pt, skipbelow=10pt,
}
\renewenvironment{quote}
	{\par\mdframed[style=QuoteFrame]}
	{\endmdframed}

% Définition de quelques motifs d'hyphenation particulier.
\hyphenation{git-hub}
\hyphenation{mark-down}
\hyphenation{wi-ki-pe-dia}
